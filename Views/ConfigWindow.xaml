<Window x:Class="PmLiteMonitor.Views.ConfigWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:ctrl="clr-namespace:PmLiteMonitor.Controls"
        Title="Configuration (Debug Mode)"
        Background="#121212" Foreground="White"
        FontFamily="Segoe UI"
        Width="720" Height="740"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        TextElement.Foreground="White"
        TextElement.FontSize="13">

    <Window.Resources>
        <!-- Override MD theme brushes that control TextBox inner text color -->
        <SolidColorBrush x:Key="MaterialDesignBody"                    Color="White"/>
        <SolidColorBrush x:Key="MaterialDesignBodyLight"               Color="#CCCCCC"/>
        <SolidColorBrush x:Key="MaterialDesignTextFieldBoxBackground"   Color="#2A2A2A"/>
        <SolidColorBrush x:Key="MaterialDesignTextAreaBorder"          Color="#666666"/>
        <SolidColorBrush x:Key="MaterialDesignTextAreaInactiveBorder"  Color="#444444"/>

        <!-- Fully custom outlined TextBox style — bypasses all MD internal foreground bindings -->
        <Style x:Key="DarkOutlinedTextBox" TargetType="TextBox">
            <Setter Property="Background"         Value="#333333"/>
            <Setter Property="Foreground"         Value="White"/>
            <Setter Property="CaretBrush"         Value="White"/>
            <Setter Property="SelectionBrush"     Value="#6690CAF9"/>
            <Setter Property="BorderBrush"        Value="#666666"/>
            <Setter Property="BorderThickness"    Value="1"/>
            <Setter Property="Padding"            Value="6,4"/>
            <Setter Property="FontSize"           Value="13"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4">
                            <!-- CRITICAL: Use TextElement.Foreground (attached), NOT Foreground -->
                            <!-- ScrollViewer.Foreground does NOT reach the inner TextBoxView -->
                            <ScrollViewer x:Name="PART_ContentHost"
                                          Focusable="False"
                                          HorizontalScrollBarVisibility="Hidden"
                                          VerticalScrollBarVisibility="Hidden"
                                          Margin="{TemplateBinding Padding}"
                                          TextElement.Foreground="White"
                                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter TargetName="border" Property="BorderBrush"     Value="#90CAF9"/>
                                <Setter TargetName="border" Property="BorderThickness" Value="2"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="BorderBrush" Value="#888888"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Apply the custom style to ALL TextBoxes in this window -->
        <Style TargetType="TextBox" BasedOn="{StaticResource DarkOutlinedTextBox}"/>

        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="White"/>
        </Style>
        <Style TargetType="CheckBox" BasedOn="{StaticResource MaterialDesignCheckBox}">
            <Setter Property="Foreground" Value="White"/>
        </Style>
    </Window.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="10">

        <!-- ═══ TCP/IP Connection ════════════════════════════════════════════ -->
        <Border Style="{StaticResource SectionBorder}" Margin="0,0,0,8">
            <StackPanel>
                <TextBlock Text="TCP/IP Connection" Style="{StaticResource SectionHeader}"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto" MinWidth="90"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto" MinWidth="120"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0" Margin="0,0,6,0">
                        <TextBlock Text="IP Address" FontSize="10" Foreground="#AAAAAA"/>
                        <TextBox Text="{Binding IpAddress, UpdateSourceTrigger=PropertyChanged}"
                                 Foreground="White" CaretBrush="White"
                                 md:HintAssist.Hint="10.0.0.1"
                                 md:HintAssist.Foreground="#AAAAAA"
                                 Height="36"/>
                        <TextBlock Text="{Binding IpError}" Foreground="#FF5555" FontSize="10"
                                   TextWrapping="Wrap" Margin="0,2,0,0"/>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Margin="0,0,6,0">
                        <TextBlock Text="Port Number" FontSize="10" Foreground="#AAAAAA"/>
                        <TextBox Text="{Binding PortText, UpdateSourceTrigger=PropertyChanged}"
                                 Foreground="White" CaretBrush="White"
                                 md:HintAssist.Hint="1024"
                                 md:HintAssist.Foreground="#AAAAAA"
                                 Height="36"/>
                        <TextBlock Text="{Binding PortError}" Foreground="#FF5555" FontSize="10"
                                   Margin="0,2,0,0"/>
                    </StackPanel>
                    <StackPanel Grid.Column="2" Margin="0,0,8,0" VerticalAlignment="Bottom">
                        <TextBlock Text="Connection Status" FontSize="10" Foreground="#AAAAAA"/>
                        <ctrl:StatusIcon State="{Binding ConnIconState}" Margin="0,4,0,0"/>
                    </StackPanel>
                    <StackPanel Grid.Column="3" VerticalAlignment="Bottom" Margin="6,0,0,0">
                        <Button Content="Connect"
                                Command="{Binding ConnectCommand}"
                                IsEnabled="{Binding IsConnected, Converter={StaticResource InverseBoolConverter}}"
                                Style="{StaticResource DisabledTooltipButton}"
                                ToolTip="Enter a valid IP address and port before connecting"
                                ToolTipService.ShowOnDisabled="True"
                                Background="#1B5E20" Foreground="White"
                                Padding="12,6" Margin="0,0,0,4"/>
                        <Button Content="Disconnect"
                                Command="{Binding DisconnectCommand}"
                                IsEnabled="{Binding IsConnected}"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Background="#B71C1C" Foreground="White"
                                Padding="12,6"/>
                    </StackPanel>
                </Grid>
                <TextBlock Text="{Binding ConnectionStatus}"
                           FontSize="10" Foreground="#AAAAAA" Margin="0,4,0,0"/>
            </StackPanel>
        </Border>

        <!-- ═══ Firmware Info ════════════════════════════════════════════════ -->
        <Border Style="{StaticResource SectionBorder}" Margin="0,0,0,8">
            <StackPanel>
                <TextBlock Text="Firmware Info" Style="{StaticResource SectionHeader}"/>
                <Grid Margin="0,4,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/><ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="Firmware Version: " Foreground="#AAAAAA"/>
                            <TextBlock Text="{Binding FwVersion}" Foreground="White"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="Firmware Serial: " Foreground="#AAAAAA"/>
                            <TextBlock Text="{Binding FwSerial}" Foreground="White"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="Firmware Build: " Foreground="#AAAAAA"/>
                            <TextBlock Text="{Binding FwBuild}" Foreground="White"/>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Grid.Column="1">
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="Firmware Date: " Foreground="#AAAAAA"/>
                            <TextBlock Text="{Binding FwDate}" Foreground="White"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <TextBlock Text="Firmware Time: " Foreground="#AAAAAA"/>
                            <TextBlock Text="{Binding FwTime}" Foreground="White"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- ═══ Configure Message ════════════════════════════════════════════ -->
        <Border Style="{StaticResource SectionBorder}" Margin="0,0,0,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/><ColumnDefinition/><ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Configure Message" Style="{StaticResource SectionHeader}"/>
                    <TextBlock Text="PAC Mode" FontSize="10" Foreground="#AAAAAA" Margin="0,4,0,4"/>
                    <CheckBox Content="Flight Mode"  IsChecked="{Binding PacFlight}"  Foreground="White" Margin="0,2"/>
                    <CheckBox Content="Missile Mode" IsChecked="{Binding PacMissile}" Foreground="White" Margin="0,2"/>
                </StackPanel>
                <StackPanel Grid.Column="1">
                    <TextBlock Text=" " Style="{StaticResource SectionHeader}"/>
                    <TextBlock Text="Terminate Mode" FontSize="10" Foreground="#AAAAAA" Margin="0,4,0,4"/>
                    <CheckBox Content="Vehicle Safed"   IsChecked="{Binding TermSafed}" Foreground="White" Margin="0,2"/>
                    <CheckBox Content="Commanded Space" IsChecked="{Binding TermArmed}" Foreground="White" Margin="0,2"/>
                    <Separator Margin="0,6" Background="#444"/>
                    <TextBlock Text="DUD Override" FontSize="10" Foreground="#AAAAAA" Margin="0,4,0,4"/>
                    <CheckBox IsChecked="{Binding DudOverride}" Foreground="White" Margin="0,2"/>
                    <TextBlock Text="Reset" FontSize="10" Foreground="#AAAAAA" Margin="0,6,0,4"/>
                    <CheckBox IsChecked="{Binding ResetFlag}" Foreground="White" Margin="0,2"/>
                </StackPanel>
                <StackPanel Grid.Column="2" VerticalAlignment="Bottom" Margin="12,0,0,0">
                    <TextBlock Text="Send Status" FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,4"/>
                    <Border CornerRadius="3" Padding="8,3" Background="#2A2A2A" Margin="0,0,0,8">
                        <TextBlock Text="{Binding ConfigSendStatus}" Foreground="White" FontSize="11"/>
                    </Border>
                    <Button Content="Send"
                            Command="{Binding SendConfigCommand}"
                            ToolTip="Connect to firmware before sending configuration"
                            ToolTipService.ShowOnDisabled="True"
                            Style="{StaticResource DisabledTooltipButton}"
                            Foreground="White" Padding="20,8"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ═══ Loopback Message ══════════════════════════════════════════════ -->
        <Border Style="{StaticResource SectionBorder}" Margin="0,0,0,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock Text="Loopback Message" Style="{StaticResource SectionHeader}"/>
                    <Grid Margin="0,6,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="70"/>
                            <ColumnDefinition/><ColumnDefinition/><ColumnDefinition/>
                            <ColumnDefinition/><ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Column headers -->
                        <TextBlock Grid.Column="1" Text="Count"  Style="{StaticResource ColHeader}"/>
                        <TextBlock Grid.Column="2" Text="Data 0" Style="{StaticResource ColHeader}"/>
                        <TextBlock Grid.Column="3" Text="Data 1" Style="{StaticResource ColHeader}"/>
                        <TextBlock Grid.Column="4" Text="Data 2" Style="{StaticResource ColHeader}"/>
                        <TextBlock Grid.Column="5" Text="Data 3" Style="{StaticResource ColHeader}"/>

                        <!-- Sent row — editable TextBoxes -->
                        <TextBlock Grid.Row="1" Text="Sent"
                                   VerticalAlignment="Center" FontSize="11" Foreground="#AAAAAA"/>
                        <StackPanel Grid.Row="1" Grid.Column="1" Margin="2">
                            <TextBox Text="{Binding LbCountText, UpdateSourceTrigger=PropertyChanged}"
                                     Foreground="White" CaretBrush="White"
                                     md:HintAssist.Hint="0–255" md:HintAssist.Foreground="#AAAAAA"
                                     Height="32"/>
                            <TextBlock Text="{Binding LbCountError}" Foreground="#FF5555" FontSize="9"/>
                        </StackPanel>
                        <StackPanel Grid.Row="1" Grid.Column="2" Margin="2">
                            <TextBox Text="{Binding LbData0Text, UpdateSourceTrigger=PropertyChanged}"
                                     Foreground="White" CaretBrush="White"
                                     md:HintAssist.Hint="0x00" md:HintAssist.Foreground="#AAAAAA"
                                     Height="32"/>
                            <TextBlock Text="{Binding LbData0Error}" Foreground="#FF5555" FontSize="9"/>
                        </StackPanel>
                        <StackPanel Grid.Row="1" Grid.Column="3" Margin="2">
                            <TextBox Text="{Binding LbData1Text, UpdateSourceTrigger=PropertyChanged}"
                                     Foreground="White" CaretBrush="White"
                                     md:HintAssist.Hint="0x00" md:HintAssist.Foreground="#AAAAAA"
                                     Height="32"/>
                            <TextBlock Text="{Binding LbData1Error}" Foreground="#FF5555" FontSize="9"/>
                        </StackPanel>
                        <StackPanel Grid.Row="1" Grid.Column="4" Margin="2">
                            <TextBox Text="{Binding LbData2Text, UpdateSourceTrigger=PropertyChanged}"
                                     Foreground="White" CaretBrush="White"
                                     md:HintAssist.Hint="0x00" md:HintAssist.Foreground="#AAAAAA"
                                     Height="32"/>
                            <TextBlock Text="{Binding LbData2Error}" Foreground="#FF5555" FontSize="9"/>
                        </StackPanel>
                        <StackPanel Grid.Row="1" Grid.Column="5" Margin="2">
                            <TextBox Text="{Binding LbData3Text, UpdateSourceTrigger=PropertyChanged}"
                                     Foreground="White" CaretBrush="White"
                                     md:HintAssist.Hint="0x00" md:HintAssist.Foreground="#AAAAAA"
                                     Height="32"/>
                            <TextBlock Text="{Binding LbData3Error}" Foreground="#FF5555" FontSize="9"/>
                        </StackPanel>

                        <!-- Received row -->
                        <TextBlock Grid.Row="2" Text="Received"
                                   VerticalAlignment="Center" FontSize="11" Foreground="#AAAAAA"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding LbRxCount}"
                                   Style="{StaticResource CellValue}" Foreground="White"/>
                        <TextBlock Grid.Row="2" Grid.Column="2" Text="{Binding LbRxData0}"
                                   Style="{StaticResource CellValue}" Foreground="White"/>
                        <TextBlock Grid.Row="2" Grid.Column="3" Text="{Binding LbRxData1}"
                                   Style="{StaticResource CellValue}" Foreground="White"/>
                        <TextBlock Grid.Row="2" Grid.Column="4" Text="{Binding LbRxData2}"
                                   Style="{StaticResource CellValue}" Foreground="White"/>
                        <TextBlock Grid.Row="2" Grid.Column="5" Text="{Binding LbRxData3}"
                                   Style="{StaticResource CellValue}" Foreground="White"/>

                        <!-- Compare row -->
                        <TextBlock Grid.Row="3" Text="Compare"
                                   VerticalAlignment="Center" FontSize="11" Foreground="#AAAAAA"/>
                        <ctrl:StatusIcon Grid.Row="3" Grid.Column="1" State="{Binding CmpCountIcon}" Margin="4,2"/>
                        <ctrl:StatusIcon Grid.Row="3" Grid.Column="2" State="{Binding CmpData0Icon}" Margin="4,2"/>
                        <ctrl:StatusIcon Grid.Row="3" Grid.Column="3" State="{Binding CmpData1Icon}" Margin="4,2"/>
                        <ctrl:StatusIcon Grid.Row="3" Grid.Column="4" State="{Binding CmpData2Icon}" Margin="4,2"/>
                        <ctrl:StatusIcon Grid.Row="3" Grid.Column="5" State="{Binding CmpData3Icon}" Margin="4,2"/>
                    </Grid>
                </StackPanel>

                <!-- Send / Stop buttons + stats -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="12,0,0,0">
                    <!-- Response timeout field -->
                    <TextBlock Text="Response Timeout (ms)" FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,2"/>
                    <TextBox Text="{Binding LbTimeoutText, UpdateSourceTrigger=PropertyChanged}"
                             Foreground="White" CaretBrush="White"
                             md:HintAssist.Hint="default 2000"
                             md:HintAssist.Foreground="#AAAAAA"
                             Height="32" Margin="0,0,0,2"/>
                    <TextBlock Text="{Binding LbTimeoutError}" Foreground="#FF5555"
                               FontSize="9" TextWrapping="Wrap" Margin="0,0,0,4"/>
                    <!-- Status -->
                    <TextBlock Text="Status" FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,2"/>
                    <Border CornerRadius="3" Padding="8,3" Background="#2A2A2A" Margin="0,0,0,4">
                        <TextBlock Text="{Binding LoopbackSendStatus}" Foreground="White"
                                   FontSize="11" TextWrapping="Wrap"/>
                    </Border>
                    <!-- Countdown / result -->
                    <TextBlock Text="{Binding LbCountRemaining}"
                               Foreground="#90CAF9" FontSize="11" FontWeight="Bold"
                               Margin="0,0,0,2"/>
                    <!-- Pass / Fail / Sent counters -->
                    <Border CornerRadius="3" Padding="8,3" Background="#1A1A1A" Margin="0,0,0,6">
                        <TextBlock Text="{Binding LbStats}" Foreground="#AAAAAA" FontSize="10"/>
                    </Border>
                    <Button Content="Send"
                            Command="{Binding SendLoopbackCommand}"
                            Style="{StaticResource DisabledTooltipButton}"
                            ToolTip="All fields must be valid (0–255 or hex). Count=255 for infinite mode."
                            ToolTipService.ShowOnDisabled="True"
                            Foreground="White" Padding="20,8" Margin="0,0,0,4"/>
                    <Button Content="Stop"
                            Command="{Binding StopLoopbackCommand}"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Background="#B71C1C" Foreground="White" Padding="20,8"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ═══ Periodic Sender ═══════════════════════════════════════════════ -->
        <Border Style="{StaticResource SectionBorder}" Margin="0,0,0,8">
            <StackPanel>
                <TextBlock Text="Periodic Sender" Style="{StaticResource SectionHeader}"/>
                <TextBlock Text="Automatically sends a message to the server on a fixed interval."
                           FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,8" TextWrapping="Wrap"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Interval -->
                    <StackPanel Grid.Column="0" Margin="0,0,8,0">
                        <TextBlock Text="Interval (seconds)" FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,2"/>
                        <TextBox Text="{Binding PeriodicIntervalText, UpdateSourceTrigger=PropertyChanged}"
                                 Foreground="White" CaretBrush="White"
                                 md:HintAssist.Hint="30"
                                 md:HintAssist.Foreground="#AAAAAA"
                                 Height="32"/>
                        <TextBlock Text="{Binding PeriodicIntervalError}"
                                   Foreground="#FF5555" FontSize="9" Margin="0,2,0,0"/>
                    </StackPanel>

                    <!-- Message type picker -->
                    <StackPanel Grid.Column="1" Margin="0,0,8,0">
                        <TextBlock Text="Message Type" FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,2"/>
                        <ComboBox SelectedValue="{Binding PeriodicMessageType}"
                                  Foreground="White" Background="#2A2A2A" Height="32"
                                  md:ComboBoxAssist.ShowSelectedItem="True">
                            <!-- Add new message types here — match the string exactly
                                 to the case in ConfigViewModel.BuildPeriodicMessage() -->
                            <ComboBoxItem Content="Null"/>
                            <ComboBoxItem Content="Status"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Start / Stop + status -->
                    <StackPanel Grid.Column="2" VerticalAlignment="Bottom">
                        <Border CornerRadius="3" Padding="8,3" Background="#2A2A2A" Margin="0,0,0,6">
                            <TextBlock Text="{Binding PeriodicStatus}"
                                       Foreground="White" FontSize="11" MinWidth="80"/>
                        </Border>
                        <Button Content="Start"
                                Command="{Binding StartPeriodicCommand}"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Background="#1B5E20" Foreground="White"
                                Padding="16,6" Margin="0,0,0,4"/>
                        <Button Content="Stop"
                                Command="{Binding StopPeriodicCommand}"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Background="#B71C1C" Foreground="White"
                                Padding="16,6"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- ═══ Status Message + Ping ════════════════════════════════════════ -->
        <Grid Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/><ColumnDefinition/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Style="{StaticResource SectionBorder}" Margin="0,0,4,0">
                <StackPanel>
                    <TextBlock Text="Status Message" Style="{StaticResource SectionHeader}"/>
                    <TextBlock Text="Data Type Request" FontSize="10" Foreground="#AAAAAA" Margin="0,4,0,6"/>
                    <CheckBox IsChecked="{Binding StatusDataType}" Foreground="White" Margin="0,2"/>
                    <Grid Margin="0,8,0,0">
                        <Grid.ColumnDefinitions><ColumnDefinition/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                        <Border CornerRadius="3" Padding="8,4" Background="#2A2A2A" VerticalAlignment="Center">
                            <TextBlock Text="{Binding StatusSendStatus}" Foreground="White" FontSize="11"/>
                        </Border>
                        <Button Grid.Column="1" Content="Send"
                                Command="{Binding SendStatusRequestCommand}"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Foreground="White"
                                Margin="8,0,0,0" Padding="16,6"/>
                    </Grid>
                </StackPanel>
            </Border>

            <Border Grid.Column="1" Style="{StaticResource SectionBorder}" Margin="4,0,0,0">
                <StackPanel>
                    <TextBlock Text="Ping" Style="{StaticResource SectionHeader}"/>
                    <TextBlock Text="IP Address" FontSize="10" Foreground="#AAAAAA"/>
                    <TextBox Text="{Binding PingAddress}"
                             Foreground="White" CaretBrush="White"
                             md:HintAssist.Hint="IP Address"
                             md:HintAssist.Foreground="#AAAAAA"
                             Margin="0,4" Height="36"/>
                    <Grid>
                        <Grid.ColumnDefinitions><ColumnDefinition/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Ping Status" FontSize="10" Foreground="#AAAAAA" Margin="0,0,0,4"/>
                            <StackPanel Orientation="Horizontal">
                                <ctrl:StatusIcon State="{Binding PingIconState}"
                                                 Width="24" Height="24" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding PingStatus}"
                                           Foreground="White"
                                           VerticalAlignment="Center" FontSize="11"/>
                            </StackPanel>
                        </StackPanel>
                        <Button Grid.Column="1" Content="Ping"
                                Command="{Binding PingCommand}"
                                Style="{StaticResource MaterialDesignRaisedButton}"
                                Background="#1B5E20" Foreground="White"
                                VerticalAlignment="Bottom" Margin="8,0,0,0" Padding="16,6"/>
                    </Grid>
                </StackPanel>
            </Border>
        </Grid>

        <!-- ═══ Debug output ══════════════════════════════════════════════════ -->
        <Border Style="{StaticResource SectionBorder}">
            <StackPanel>
                <TextBlock Text="Debug Output" Style="{StaticResource SectionHeader}"/>
                <ScrollViewer MaxHeight="100" VerticalScrollBarVisibility="Auto">
                    <TextBox Text="{Binding DebugOutput, Mode=OneWay}"
                             IsReadOnly="True"
                             Background="Transparent" BorderThickness="0"
                             Foreground="#CCCCCC" CaretBrush="White"
                             FontFamily="Consolas" FontSize="10"
                             TextWrapping="Wrap"
                             md:HintAssist.Hint="Debug Mode TextBox"
                             md:HintAssist.Foreground="#AAAAAA"/>
                </ScrollViewer>
            </StackPanel>
        </Border>

    </StackPanel>
    </ScrollViewer>
</Window>
